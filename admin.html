<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VCML | ê´€ë¦¬ì í˜ì´ì§€</title>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        :root { --deep-blue: #0310A1; --primary: #046EF2; --bg: #F5F7FA; }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Pretendard', sans-serif; background: var(--bg); color: #333; padding: 20px; }

        /* ë¡œê·¸ì¸ ì˜¤ë²„ë ˆì´ */
        #loginOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(3, 16, 161, 0.95); z-index: 9999;
            display: flex; justify-content: center; align-items: center; flex-direction: column;
        }
        .login-box { text-align: center; background: white; padding: 40px; border-radius: 20px; width: 300px; }
        .login-box h2 { margin-bottom: 20px; color: var(--deep-blue); }
        .login-input { 
            width: 100%; padding: 12px; margin-bottom: 15px; border: 1px solid #ddd; 
            border-radius: 8px; font-size: 1rem; text-align: center;
        }
        .btn-login {
            width: 100%; padding: 12px; background: var(--primary); color: white;
            border: none; border-radius: 8px; font-weight: bold; cursor: pointer;
        }

        /* ë©”ì¸ ì»¨í…ì¸  */
        .container { max-width: 800px; margin: 0 auto; display: none; } /* ë¡œê·¸ì¸ ì „ ìˆ¨ê¹€ */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .header h1 { font-size: 1.8rem; color: var(--deep-blue); }
        .btn-refresh { 
            padding: 8px 16px; background: white; border: 1px solid #ddd; 
            border-radius: 6px; cursor: pointer; font-size: 0.9rem; 
        }

        /* í•„í„° íƒ­ */
        .tabs { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { 
            padding: 8px 16px; background: #e0e0e0; border-radius: 20px; 
            cursor: pointer; font-weight: 600; font-size: 0.9rem; color: #666;
        }
        .tab.active { background: var(--deep-blue); color: white; }

        /* ë¦¬ìŠ¤íŠ¸ ìŠ¤íƒ€ì¼ */
        .inquiry-list { display: flex; flex-direction: column; gap: 15px; }
        .inquiry-card {
            background: white; padding: 20px; border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05); border-left: 5px solid #ddd;
        }
        .inquiry-card.qna { border-left-color: var(--primary); } /* ë¬¸ì˜ëŠ” íŒŒë€ìƒ‰ ë  */
        .inquiry-card.test { border-left-color: #03C75A; } /* ì§„ë‹¨ì€ ì´ˆë¡ìƒ‰ ë  */

        .card-header { display: flex; justify-content: space-between; margin-bottom: 10px; font-size: 0.85rem; color: #888; }
        .badge { 
            padding: 4px 8px; border-radius: 4px; font-weight: bold; font-size: 0.75rem; 
            background: #eee; color: #555;
        }
        .badge.qna { background: rgba(4, 110, 242, 0.1); color: var(--primary); }
        
        .card-body h3 { font-size: 1.1rem; margin-bottom: 8px; color: #333; }
        .card-body p { font-size: 0.95rem; color: #555; white-space: pre-wrap; line-height: 1.5; }
        .card-footer { 
            margin-top: 15px; padding-top: 15px; border-top: 1px solid #eee; 
            font-size: 0.9rem; font-weight: 600; color: var(--deep-blue);
        }
    </style>
</head>
<body>

    <!-- ë¡œê·¸ì¸ í™”ë©´ -->
    <div id="loginOverlay">
        <div class="login-box">
            <h2>ADMIN LOGIN</h2>
            <input type="password" id="adminPw" class="login-input" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥">
            <button class="btn-login" onclick="checkLogin()">ì ‘ì†í•˜ê¸°</button>
        </div>
    </div>

    <!-- ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ -->
    <div class="container" id="dashboard">
        <div class="header">
            <h1>ê³ ê° ë¬¸ì˜ ê´€ë¦¬</h1>
            <button class="btn-refresh" onclick="loadData()">ğŸ”„ ìƒˆë¡œê³ ì¹¨</button>
        </div>

        <div class="tabs">
            <div class="tab active" onclick="filterData('all', this)">ì „ì²´</div>
            <div class="tab" onclick="filterData('qna', this)">ë¬¸ì˜ê²Œì‹œíŒ</div>
            <div class="tab" onclick="filterData('test', this)">ì§„ë‹¨ê²°ê³¼</div>
        </div>

        <div class="inquiry-list" id="listContainer">
            <div style="text-align:center; padding:50px; color:#888;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
        </div>
    </div>

    <script>
        // â–¼â–¼â–¼ ë³¸ì¸ ì•±ìŠ¤ ìŠ¤í¬ë¦½íŠ¸ URL (index.htmlê³¼ ë™ì¼) â–¼â–¼â–¼
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzx-VPvaNewhDu8KTO58kIVXbRz3aoJyuWLhb6lPZgpWk6-b1yjmkuEDnLXeYdakTH1pw/exec"; 
        
        // â˜… ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì„¤ì • (ì›í•˜ëŠ” ê±¸ë¡œ ë°”ê¾¸ì„¸ìš”) â˜…
        const PASSWORD = "01055064511"; 

        let allData = [];

        // 1. ë¡œê·¸ì¸ ì²´í¬
        function checkLogin() {
            const input = document.getElementById('adminPw').value;
            if(input === PASSWORD) {
                document.getElementById('loginOverlay').style.display = 'none';
                document.getElementById('dashboard').style.display = 'block';
                loadData(); // ë°ì´í„° ë¡œë“œ ì‹œì‘
            } else {
                alert("ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤.");
            }
        }

        // 2. ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° (GET)
        function loadData() {
            document.getElementById('listContainer').innerHTML = '<div style="text-align:center; padding:50px; color:#888;">ë°ì´í„° ë¡œë”© ì¤‘...</div>';
            
            fetch(SCRIPT_URL)
                .then(response => response.json())
                .then(data => {
                    allData = data;
                    renderList(data); // ì „ì²´ ë Œë”ë§
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('listContainer').innerHTML = '<div style="text-align:center; color:red;">ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨</div>';
                });
        }

        // 3. ë¦¬ìŠ¤íŠ¸ ê·¸ë¦¬ê¸°
        function renderList(data) {
            const container = document.getElementById('listContainer');
            container.innerHTML = '';

            if(data.length === 0) {
                container.innerHTML = '<div style="text-align:center; padding:50px;">ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }

            data.forEach(item => {
                // ë‚ ì§œ í¬ë§·íŒ…
                const date = new Date(item.time).toLocaleDateString('ko-KR', { month: 'long', day: 'numeric', hour: '2-digit', minute:'2-digit' });
                
                // êµ¬ë¶„ (ë¬¸ì˜ vs ì§„ë‹¨)
                const isQna = item.category === 'ë¬¸ì˜ê²Œì‹œíŒ';
                const badgeClass = isQna ? 'qna' : 'test';
                const typeName = isQna ? 'ë¬¸ì˜ê²Œì‹œíŒ' : item.category;

                // ë‚´ìš© êµ¬ì„±
                let titleHtml = isQna ? `<h3>${item.title}</h3>` : `<h3>${item.category} - ${item.title || 'ì§„ë‹¨ì™„ë£Œ'}</h3>`; // ì§„ë‹¨ì€ titleì´ ë ˆë²¨ì¼ ìˆ˜ ìˆìŒ
                let contentHtml = isQna ? `<p>${item.content}</p>` : `<p>ì§„ë‹¨ ê²°ê³¼: ${item.title || ''}</p>`;

                const html = `
                    <div class="inquiry-card ${badgeClass}">
                        <div class="card-header">
                            <span class="badge ${badgeClass}">${typeName}</span>
                            <span>${date}</span>
                        </div>
                        <div class="card-body">
                            ${titleHtml}
                            ${contentHtml}
                        </div>
                        <div class="card-footer">
                            ${item.name} (${item.phone})
                        </div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // 4. íƒ­ í•„í„°ë§
        function filterData(type, tabElement) {
            // íƒ­ ìŠ¤íƒ€ì¼ ë³€ê²½
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            tabElement.classList.add('active');

            // ë°ì´í„° í•„í„°ë§
            if(type === 'all') {
                renderList(allData);
            } else if(type === 'qna') {
                const filtered = allData.filter(item => item.category === 'ë¬¸ì˜ê²Œì‹œíŒ');
                renderList(filtered);
            } else if(type === 'test') {
                const filtered = allData.filter(item => item.category !== 'ë¬¸ì˜ê²Œì‹œíŒ');
                renderList(filtered);
            }
        }
        
        // ì—”í„°í‚¤ ë¡œê·¸ì¸ ì§€ì›
        document.getElementById('adminPw').addEventListener("keypress", function(event) {
            if (event.key === "Enter") checkLogin();
        });
    </script>

</body>
</html>
